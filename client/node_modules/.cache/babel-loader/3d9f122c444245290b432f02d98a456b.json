{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Api = void 0;\n\nconst body_parser_1 = __importDefault(require(\"body-parser\"));\n\nconst cors_1 = __importDefault(require(\"cors\"));\n\nconst express_1 = __importDefault(require(\"express\"));\n\nconst app_json_1 = __importDefault(require(\"../../app.json\"));\n\nconst auth_1 = require(\"./middleware/auth\");\n\nconst calls_1 = __importDefault(require(\"./v1/calls\"));\n\nconst public_1 = __importDefault(require(\"./v1/public\"));\n\nconst Api = ({\n  config,\n  realm,\n  messageHandler\n}) => {\n  const authMiddleware = new auth_1.AuthMiddleware(config, realm);\n  const app = express_1.default.Router();\n  const jsonParser = body_parser_1.default.json();\n  app.use(cors_1.default());\n  app.get(\"/\", (_, res) => {\n    res.send(app_json_1.default);\n  });\n  app.use(\"/:key\", public_1.default({\n    config,\n    realm\n  }));\n  app.use(\"/:key/:id/:token\", authMiddleware.handle, jsonParser, calls_1.default({\n    realm,\n    messageHandler\n  }));\n  return app;\n};\n\nexports.Api = Api;","map":{"version":3,"sources":["/usr/local/lib/node_modules/peer/dist/src/api/index.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","Api","body_parser_1","require","cors_1","express_1","app_json_1","auth_1","calls_1","public_1","config","realm","messageHandler","authMiddleware","AuthMiddleware","app","default","Router","jsonParser","json","use","get","_","res","send","handle"],"mappings":"AAAA;;AACA,IAAIA,eAAe,GAAI,QAAQ,KAAKA,eAAd,IAAkC,UAAUC,GAAV,EAAe;AACnE,SAAQA,GAAG,IAAIA,GAAG,CAACC,UAAZ,GAA0BD,GAA1B,GAAgC;AAAE,eAAWA;AAAb,GAAvC;AACH,CAFD;;AAGAE,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,GAAR,GAAc,KAAK,CAAnB;;AACA,MAAMC,aAAa,GAAGR,eAAe,CAACS,OAAO,CAAC,aAAD,CAAR,CAArC;;AACA,MAAMC,MAAM,GAAGV,eAAe,CAACS,OAAO,CAAC,MAAD,CAAR,CAA9B;;AACA,MAAME,SAAS,GAAGX,eAAe,CAACS,OAAO,CAAC,SAAD,CAAR,CAAjC;;AACA,MAAMG,UAAU,GAAGZ,eAAe,CAACS,OAAO,CAAC,gBAAD,CAAR,CAAlC;;AACA,MAAMI,MAAM,GAAGJ,OAAO,CAAC,mBAAD,CAAtB;;AACA,MAAMK,OAAO,GAAGd,eAAe,CAACS,OAAO,CAAC,YAAD,CAAR,CAA/B;;AACA,MAAMM,QAAQ,GAAGf,eAAe,CAACS,OAAO,CAAC,aAAD,CAAR,CAAhC;;AACA,MAAMF,GAAG,GAAG,CAAC;AAAES,EAAAA,MAAF;AAAUC,EAAAA,KAAV;AAAiBC,EAAAA;AAAjB,CAAD,KAAuC;AAC/C,QAAMC,cAAc,GAAG,IAAIN,MAAM,CAACO,cAAX,CAA0BJ,MAA1B,EAAkCC,KAAlC,CAAvB;AACA,QAAMI,GAAG,GAAGV,SAAS,CAACW,OAAV,CAAkBC,MAAlB,EAAZ;AACA,QAAMC,UAAU,GAAGhB,aAAa,CAACc,OAAd,CAAsBG,IAAtB,EAAnB;AACAJ,EAAAA,GAAG,CAACK,GAAJ,CAAQhB,MAAM,CAACY,OAAP,EAAR;AACAD,EAAAA,GAAG,CAACM,GAAJ,CAAQ,GAAR,EAAa,CAACC,CAAD,EAAIC,GAAJ,KAAY;AACrBA,IAAAA,GAAG,CAACC,IAAJ,CAASlB,UAAU,CAACU,OAApB;AACH,GAFD;AAGAD,EAAAA,GAAG,CAACK,GAAJ,CAAQ,OAAR,EAAiBX,QAAQ,CAACO,OAAT,CAAiB;AAAEN,IAAAA,MAAF;AAAUC,IAAAA;AAAV,GAAjB,CAAjB;AACAI,EAAAA,GAAG,CAACK,GAAJ,CAAQ,kBAAR,EAA4BP,cAAc,CAACY,MAA3C,EAAmDP,UAAnD,EAA+DV,OAAO,CAACQ,OAAR,CAAgB;AAAEL,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAhB,CAA/D;AACA,SAAOG,GAAP;AACH,CAXD;;AAYAhB,OAAO,CAACE,GAAR,GAAcA,GAAd","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Api = void 0;\nconst body_parser_1 = __importDefault(require(\"body-parser\"));\nconst cors_1 = __importDefault(require(\"cors\"));\nconst express_1 = __importDefault(require(\"express\"));\nconst app_json_1 = __importDefault(require(\"../../app.json\"));\nconst auth_1 = require(\"./middleware/auth\");\nconst calls_1 = __importDefault(require(\"./v1/calls\"));\nconst public_1 = __importDefault(require(\"./v1/public\"));\nconst Api = ({ config, realm, messageHandler }) => {\n    const authMiddleware = new auth_1.AuthMiddleware(config, realm);\n    const app = express_1.default.Router();\n    const jsonParser = body_parser_1.default.json();\n    app.use(cors_1.default());\n    app.get(\"/\", (_, res) => {\n        res.send(app_json_1.default);\n    });\n    app.use(\"/:key\", public_1.default({ config, realm }));\n    app.use(\"/:key/:id/:token\", authMiddleware.handle, jsonParser, calls_1.default({ realm, messageHandler }));\n    return app;\n};\nexports.Api = Api;\n"]},"metadata":{},"sourceType":"script"}