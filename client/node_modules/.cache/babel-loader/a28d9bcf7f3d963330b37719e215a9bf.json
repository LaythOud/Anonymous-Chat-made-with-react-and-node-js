{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Realm = void 0;\n\nconst v4_1 = __importDefault(require(\"uuid/v4\"));\n\nconst messageQueue_1 = require(\"./messageQueue\");\n\nclass Realm {\n  constructor() {\n    this.clients = new Map();\n    this.messageQueues = new Map();\n  }\n\n  getClientsIds() {\n    return [...this.clients.keys()];\n  }\n\n  getClientById(clientId) {\n    return this.clients.get(clientId);\n  }\n\n  getClientsIdsWithQueue() {\n    return [...this.messageQueues.keys()];\n  }\n\n  setClient(client, id) {\n    this.clients.set(id, client);\n  }\n\n  removeClientById(id) {\n    const client = this.getClientById(id);\n    if (!client) return false;\n    this.clients.delete(id);\n    return true;\n  }\n\n  getMessageQueueById(id) {\n    return this.messageQueues.get(id);\n  }\n\n  addMessageToQueue(id, message) {\n    var _a;\n\n    if (!this.getMessageQueueById(id)) {\n      this.messageQueues.set(id, new messageQueue_1.MessageQueue());\n    }\n\n    (_a = this.getMessageQueueById(id)) === null || _a === void 0 ? void 0 : _a.addMessage(message);\n  }\n\n  clearMessageQueue(id) {\n    this.messageQueues.delete(id);\n  }\n\n  generateClientId(generateClientId) {\n    const generateId = generateClientId ? generateClientId : v4_1.default;\n    let clientId = generateId();\n\n    while (this.getClientById(clientId)) {\n      clientId = generateId();\n    }\n\n    return clientId;\n  }\n\n}\n\nexports.Realm = Realm;","map":{"version":3,"sources":["/usr/local/lib/node_modules/peer/dist/src/models/realm.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","Realm","v4_1","require","messageQueue_1","constructor","clients","Map","messageQueues","getClientsIds","keys","getClientById","clientId","get","getClientsIdsWithQueue","setClient","client","id","set","removeClientById","delete","getMessageQueueById","addMessageToQueue","message","_a","MessageQueue","addMessage","clearMessageQueue","generateClientId","generateId","default"],"mappings":"AAAA;;AACA,IAAIA,eAAe,GAAI,QAAQ,KAAKA,eAAd,IAAkC,UAAUC,GAAV,EAAe;AACnE,SAAQA,GAAG,IAAIA,GAAG,CAACC,UAAZ,GAA0BD,GAA1B,GAAgC;AAAE,eAAWA;AAAb,GAAvC;AACH,CAFD;;AAGAE,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,KAAR,GAAgB,KAAK,CAArB;;AACA,MAAMC,IAAI,GAAGR,eAAe,CAACS,OAAO,CAAC,SAAD,CAAR,CAA5B;;AACA,MAAMC,cAAc,GAAGD,OAAO,CAAC,gBAAD,CAA9B;;AACA,MAAMF,KAAN,CAAY;AACRI,EAAAA,WAAW,GAAG;AACV,SAAKC,OAAL,GAAe,IAAIC,GAAJ,EAAf;AACA,SAAKC,aAAL,GAAqB,IAAID,GAAJ,EAArB;AACH;;AACDE,EAAAA,aAAa,GAAG;AACZ,WAAO,CAAC,GAAG,KAAKH,OAAL,CAAaI,IAAb,EAAJ,CAAP;AACH;;AACDC,EAAAA,aAAa,CAACC,QAAD,EAAW;AACpB,WAAO,KAAKN,OAAL,CAAaO,GAAb,CAAiBD,QAAjB,CAAP;AACH;;AACDE,EAAAA,sBAAsB,GAAG;AACrB,WAAO,CAAC,GAAG,KAAKN,aAAL,CAAmBE,IAAnB,EAAJ,CAAP;AACH;;AACDK,EAAAA,SAAS,CAACC,MAAD,EAASC,EAAT,EAAa;AAClB,SAAKX,OAAL,CAAaY,GAAb,CAAiBD,EAAjB,EAAqBD,MAArB;AACH;;AACDG,EAAAA,gBAAgB,CAACF,EAAD,EAAK;AACjB,UAAMD,MAAM,GAAG,KAAKL,aAAL,CAAmBM,EAAnB,CAAf;AACA,QAAI,CAACD,MAAL,EACI,OAAO,KAAP;AACJ,SAAKV,OAAL,CAAac,MAAb,CAAoBH,EAApB;AACA,WAAO,IAAP;AACH;;AACDI,EAAAA,mBAAmB,CAACJ,EAAD,EAAK;AACpB,WAAO,KAAKT,aAAL,CAAmBK,GAAnB,CAAuBI,EAAvB,CAAP;AACH;;AACDK,EAAAA,iBAAiB,CAACL,EAAD,EAAKM,OAAL,EAAc;AAC3B,QAAIC,EAAJ;;AACA,QAAI,CAAC,KAAKH,mBAAL,CAAyBJ,EAAzB,CAAL,EAAmC;AAC/B,WAAKT,aAAL,CAAmBU,GAAnB,CAAuBD,EAAvB,EAA2B,IAAIb,cAAc,CAACqB,YAAnB,EAA3B;AACH;;AACD,KAACD,EAAE,GAAG,KAAKH,mBAAL,CAAyBJ,EAAzB,CAAN,MAAwC,IAAxC,IAAgDO,EAAE,KAAK,KAAK,CAA5D,GAAgE,KAAK,CAArE,GAAyEA,EAAE,CAACE,UAAH,CAAcH,OAAd,CAAzE;AACH;;AACDI,EAAAA,iBAAiB,CAACV,EAAD,EAAK;AAClB,SAAKT,aAAL,CAAmBY,MAAnB,CAA0BH,EAA1B;AACH;;AACDW,EAAAA,gBAAgB,CAACA,gBAAD,EAAmB;AAC/B,UAAMC,UAAU,GAAGD,gBAAgB,GAAGA,gBAAH,GAAsB1B,IAAI,CAAC4B,OAA9D;AACA,QAAIlB,QAAQ,GAAGiB,UAAU,EAAzB;;AACA,WAAO,KAAKlB,aAAL,CAAmBC,QAAnB,CAAP,EAAqC;AACjCA,MAAAA,QAAQ,GAAGiB,UAAU,EAArB;AACH;;AACD,WAAOjB,QAAP;AACH;;AA5CO;;AA8CZb,OAAO,CAACE,KAAR,GAAgBA,KAAhB","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Realm = void 0;\nconst v4_1 = __importDefault(require(\"uuid/v4\"));\nconst messageQueue_1 = require(\"./messageQueue\");\nclass Realm {\n    constructor() {\n        this.clients = new Map();\n        this.messageQueues = new Map();\n    }\n    getClientsIds() {\n        return [...this.clients.keys()];\n    }\n    getClientById(clientId) {\n        return this.clients.get(clientId);\n    }\n    getClientsIdsWithQueue() {\n        return [...this.messageQueues.keys()];\n    }\n    setClient(client, id) {\n        this.clients.set(id, client);\n    }\n    removeClientById(id) {\n        const client = this.getClientById(id);\n        if (!client)\n            return false;\n        this.clients.delete(id);\n        return true;\n    }\n    getMessageQueueById(id) {\n        return this.messageQueues.get(id);\n    }\n    addMessageToQueue(id, message) {\n        var _a;\n        if (!this.getMessageQueueById(id)) {\n            this.messageQueues.set(id, new messageQueue_1.MessageQueue());\n        }\n        (_a = this.getMessageQueueById(id)) === null || _a === void 0 ? void 0 : _a.addMessage(message);\n    }\n    clearMessageQueue(id) {\n        this.messageQueues.delete(id);\n    }\n    generateClientId(generateClientId) {\n        const generateId = generateClientId ? generateClientId : v4_1.default;\n        let clientId = generateId();\n        while (this.getClientById(clientId)) {\n            clientId = generateId();\n        }\n        return clientId;\n    }\n}\nexports.Realm = Realm;\n"]},"metadata":{},"sourceType":"script"}